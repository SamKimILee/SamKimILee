<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>JOURNIVERSE | DIARY</title>
    <link rel="stylesheet" href="/css/diary/diary-home.css">
    
    <!-- ✅ TUI Calendar CSS -->
	<link rel="stylesheet" href="https://uicdn.toast.com/tui-calendar/latest/tui-calendar.min.css">

	<!-- ✅ 필수 JS 라이브러리 -->
	<script src="https://uicdn.toast.com/tui.code-snippet/latest/tui-code-snippet.min.js"></script>
	<script src="https://uicdn.toast.com/tui-calendar/latest/tui-calendar.min.js"></script>
</head>
<body>

    <div class="container">
        <div class="main-content">
            <h1>I decide my own feelings.<br>Today, it's going to be <span class="highlight">happiness.</span></h1>
            <p class="quote">“내 기분은 내가 정해. 오늘은 행복으로 할래.” - 이상한 나라의 앨리스</p>

            <div class="button-group">
                <a href="/diary/insert" class="btn write-journal">Write Journal</a>
                <a href="#" id="readJournalBtn" class="btn read-journal">Read Journal</a>
            </div>
        </div>

        <!-- 📌 캘린더 컨테이너 -->
        <div class="calendar-wrapper">
            <div class="calendar-header">
                <select id="yearSelect"></select>
                <select id="monthSelect"></select>
            </div>
            <div id="calendar"></div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            console.log("DOMContentLoaded 실행됨");

            if (typeof tui.Calendar === 'undefined') {
                console.error("🚨 TUI Calendar 라이브러리가 로드되지 않음!");
                return;
            }
			
         // ✅ 오늘 날짜를 가져와서 "YYYY-MM-DD" 형식으로 변환하는 함수
            function getTodayDate() {
                let today = new Date();
                let year = today.getFullYear();
                let month = String(today.getMonth() + 1).padStart(2, '0'); // 2자리로 변환
                let day = String(today.getDate()).padStart(2, '0'); // 2자리로 변환
                return `${year}-${month}-${day}`;
            }

            // ✅ Read Journal 버튼 클릭 시, 오늘 날짜를 포함한 URL로 이동
            document.getElementById("readJournalBtn").addEventListener("click", function(event) {
                event.preventDefault(); // 기본 동작 방지
                let todayDate = getTodayDate(); // 오늘 날짜 가져오기
                window.location.href = `/diary/${todayDate}`; // URL 이동
            });
            
            // ✅ 년도와 월 선택을 위한 select 박스 설정
            const yearSelect = document.getElementById("yearSelect");
            const monthSelect = document.getElementById("monthSelect");

            let currentYear = new Date().getFullYear();
            let currentMonth = new Date().getMonth() + 1;

            for (let y = 2020; y <= 2030; y++) {
                let option = document.createElement("option");
                option.value = y;
                option.textContent = y + " 년";
                if (y === currentYear) option.selected = true;
                yearSelect.appendChild(option);
            }

            for (let m = 1; m <= 12; m++) {
                let option = document.createElement("option");
                option.value = m;
                option.textContent = m + " 월";
                if (m === currentMonth) option.selected = true;
                monthSelect.appendChild(option);
            }

            var cal = new tui.Calendar("#calendar", {
                defaultView: "month",
                useCreationPopup: true,
                useDetailPopup: true,
            });

            // 📌 년도/월 선택 시 달력 업데이트
            function setMonthYear() {
                let selectedYear = yearSelect.value;
                let selectedMonth = monthSelect.value;
                cal.setDate(new Date(selectedYear, selectedMonth - 1, 1));
            }

            yearSelect.addEventListener("change", setMonthYear);
            monthSelect.addEventListener("change", setMonthYear);

            cal.render();
        });
    </script>

</body>
</html>
